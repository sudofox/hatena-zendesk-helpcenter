{
  "article": {
    "id": 18579282511385,
    "url": "https://hatenablogmedia.zendesk.com/api/v2/help_center/ja/articles/18579282511385.json",
    "html_url": "https://hatenablogmedia.zendesk.com/hc/ja/articles/18579282511385",
    "author_id": 900846704823,
    "comments_disabled": false,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 16028613025305,
    "created_at": "2023-05-16T09:43:19Z",
    "updated_at": "2023-06-15T06:55:51Z",
    "name": "Google Analyticsとの連携について",
    "title": "Google Analyticsとの連携について",
    "source_locale": "ja",
    "locale": "ja",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2023-06-15T05:42:00Z",
    "user_segment_id": null,
    "permission_group_id": 972311,
    "content_tag_ids": [],
    "label_names": [],
    "body": "<p class=\"alert alert-info\">2023年5月以前にsimple-p1を導入し、Universal Analytics設定を行ったユーザー向けの説明ページとなります。<br>2023年6月現在、この設定はGA4には対応しておらず、UA専用となっています。ご了承ください。<br>GA4でははてなブログ全体として独自に取得できる項目が設定できます。詳細は「<a href=\"https://staff.hatenablog.com/entry/2022/04/27/152529#%E8%BF%BD%E5%8A%A0%E3%81%95%E3%82%8C%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF\">追加されるデータ</a>」をご覧ください。</p>\n<p>hbm-simple-p1ではGoogle Anayitcsに対して以下の様なデータを送信できる設計となっています。</p>\n<ul>\n<li> 記事のソーシャルボタンのクリック（イベントを使用）</li>\n<li> 記事の文字数レンジの計測（1000文字単位、カスタムディメンションを使用）</li>\n<li> 記事のメインカテゴリーの計測（コンテンツカテゴリーを使用）</li>\n<li> 記事の読了</li>\n</ul>\n<p>この機能を利用される場合は以下に従って設定してください。</p>\n<h3>Google Analytics側での準備</h3>\n<p>利用するUniversalAnalyticsのプロパティで以下の設定を行います。</p>\n<h4>\n<span class=\"step\">STEP1</span>「文字数」を取得するためのカスタムディメンション設定</h4>\n<ul>\n<li>Google Analyticsで対象となるプロパティを開き、画面左下の管理アイコンから、<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18653048842009\" alt=\"______Media________hbm-simple-p1__________________65____0002.png\" width=\"121\" height=\"184\"><br>対象プロパティの「カスタム定義」-「カスタムディメンション」を選択<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18653402801305\" alt=\"______Media________hbm-simple-p1__________________64____0002.png\" width=\"622\" height=\"507\">\n</li>\n<li>「新しいカスタムディメンション」を選択し、任意の名前（「文字数」を推奨）を入力。<br>範囲を「セッション」として「作成」を選択<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18653512544025\" alt=\"______Media________hbm-simple-p1__________________64____0003.png\" width=\"310\" height=\"325\">\n</li>\n<li>「作成したカスタムディメンション」の画面が表示されたら、「JavaScript」の枠に表<br>示される「ga('set', 'dimension1', dimensionValue);」の「dimension1」部分をメモ<br>しておく。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812003722393\" alt=\"______Media________hbm-simple-p1__________________65____0001.png\" width=\"552\" height=\"528\">\n</li>\n</ul>\n<h4>\n<span class=\"step\">STEP2</span>記事のメインカテゴリーを取得するための「コンテンツカテゴリー」設定</h4>\n<ul>\n<li>Google Analyticsで対象となるプロパティを開き、画面左下の管理アイコンから、<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812250852761\" alt=\"______Media________hbm-simple-p1__________________65____0002.png\" width=\"102\" height=\"155\"><br>対象プロパティ中の利用するビューから「コンテンツグループ」を選択<br>（デフォルトでは「すべてのウェブサイトのデータ」になります。）<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812205269657\" alt=\"______Media________hbm-simple-p1__________________65____0003.png\" width=\"617\" height=\"198\">\n</li>\n<li>「新しいコンテンツグループ」を選択し、コンテンツグループ名に「カテゴリー」と入力<br>「トラッキングコードの有効化」をクリック<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812249487129\" alt=\"______Media________hbm-simple-p1__________________65____0004.png\" width=\"611\" height=\"207\">\n</li>\n<li>画面が切り替わり、「有効化」が「オン」、インデックスが「1」になっていることを確<br>認し「完了」を選択<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812191567513\" alt=\"______Media________hbm-simple-p1__________________66____0001.png\" width=\"611\" height=\"444\">\n</li>\n<li>そのまま他の項目は設定せず「保存」を選択<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812236044185\" alt=\"______Media________hbm-simple-p1__________________66____0002.png\" width=\"541\" height=\"274\">\n</li>\n</ul>\n<h3>ブログの管理画面での設定</h3>\n<p><a href=\"https://blog.hatena.ne.jp/\" target=\"_blank\" rel=\"noopener noreferrer\">管理画面</a> &gt; [設定] &gt; [詳細設定]を開く</p>\n<p><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812249612825\" alt=\"______Media________hbm-simple-p1__________________67____0001.png\" width=\"473\" height=\"564\"></p>\n<p>「&lt;head&gt;要素にメタデータを追加」の入力欄に以下内容を設定 </p>\n<h4>\n<span class=\"step\">STEP1</span>プロパティIDの設定</h4>\n<ul>\n<li>\n<code>\"UA-69076420-12\"</code> 部分を利用されるプロパティIDに必ず置き換えてください<br>\n<div>\n<pre>&lt;script&gt;<br><br>    window.dataLayer = window.dataLayer || [];<br><br>    // ここにUAを設定してください<br><br>    window.GaId = \"UA-69076420-12\";<br><br>    ～<br><br>&lt;/script&gt;</pre>\n</div>\n</li>\n</ul>\n<p class=\"alert alert-info\"> はてなブログの管理画面上にもUniversal Analytics用の設定項目がありますが、hbm-simple-p1テーマの計測機能を利用される場合は、下記の入力欄は必ず空白のままとしてください<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812258901273\" alt=\"______Media________hbm-simple-p1__________________67____0002.png\" width=\"557\" height=\"160\"><br>両方の箇所でプロパティIDを設定すると、Google Analyticsで二重計測が発生しますのでご注意ください。<br>GA4についてはhbm-simple-p1テーマでデータ送信などは行わないため、併用される場合は以下の入力欄で測定IDを設定いただいて問題ありません<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812251197209\" alt=\"______Media________hbm-simple-p1__________________68____0001.png\" width=\"550\" height=\"140\"></p>\n<h4>\n<span class=\"step\">STEP2</span>カスタムディメンションの設定</h4>\n<ul>\n<li>前項「<strong>STEP1「文字数」を取得するためのカスタムディメンション設定</strong>」の設定時に表示されたカスタムディメンションの定義文字列が下記の<code>{dimension1: \"文字数\"}</code>と異なる場合は置き換えてください。<br>\n<div>\n<pre>gtag(\"config\", window.GaId, countCharactersPages.some(e=&gt;location.pathname.startsWith(e))? {<br><br>        send_page_view: false,<br><br>        content_group1: category,<br><br>        custom_map: {dimension1: \"文字数\"},<br><br>    }</pre>\n</div>\n</li>\n</ul>\n<h4>\n<span class=\"step\">STEP3</span>保存</h4>\n<ul>\n<li>前項で設定内容の変更を行った場合は、管理画面最下部の「保存」を選択し内容を確定させてください。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812251251225\" alt=\"______Media________hbm-simple-p1__________________68____0002.png\" width=\"423\" height=\"172\">\n</li>\n</ul>\n<h3>Google Analytics上での計測値の確認</h3>\n<p>前項で設定した内容の確認例をご紹介します。</p>\n<ul>\n<li>記事のソーシャルボタンのクリック\n<ul>\n<li>各種ソーシャルボタンのクリックは、以下の様な内容でイベントとして記録されています。\n<ul>\n<li>イベントアクション：click</li>\n<li>イベントカテゴリー：\n<ul>\n<li>はてなブックマークボタン：hbm-hatebu</li>\n<li>Twitterボタン：hbm-twitter</li>\n<li>Facebookボタン：hbm-facebook</li>\n<li>LINEボタン：hbm-line</li>\n</ul>\n</li>\n<li>イベントラベル：記事のURL\n<ul>\n<li>例：<a href=\"https://business.hatenastaff.com/entry/2022/07/06/113000\" target=\"_blank\" rel=\"noopener noreferrer\">https://business.hatenastaff.com/entry/2022/07/06/113000</a>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>レポート画面例\n<ul>\n<ul>\n<li>以下は、Google Analyticsの「行動」-「イベント」-「上位のイベント」画面です。<br>イベントアクションとして「click」を指定、セカンダリディメンションで「ページ」を設定した場合の表示例です。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18812222647577\" alt=\"______Media________hbm-simple-p1__________________69____0001.png\" width=\"493\" height=\"290\">\n</li>\n<li>「各記事でどのシェアボタンがクリックされているか」等を確認することが可能です。</li>\n<li>活用される場合は、カスタムレポートの機能などを利用してください。</li>\n</ul>\n</ul>\n<p class=\"alert alert-info\">この設定で取得可能なのは、デザインテーマにてデフォルトで設定されたボタンのクリック・押下のみとなります。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18820239402905\" alt=\"______Media________hbm-simple-p1__________________69____0002.png\" width=\"344\" height=\"155\"><br>管理画面 &gt; [デザイン] &gt; [記事] &gt; [ソーシャルパーツ]にて設定した表示ボタンに対しての計測は行うことができません。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18820262231449\" alt=\"______Media________hbm-simple-p1__________________69____0003.png\" width=\"334\" height=\"174\"></p>\n</li>\n</ul>\n</li>\n<li>読了\n<ul>\n<li>記事の読了については、以下の様な内容でイベントとして記録されています。\n<ul>\n<li>イベントアクション：read-finished</li>\n<li>イベントカテゴリー：general</li>\n<li>イベントラベル：記事のURL</li>\n</ul>\n</li>\n<li>レポート画面例\n<ul>\n<li>以下は、Google Analyticsの「行動」-「イベント」-「上位のイベント」画面で、イベントアクションとして「read-finished」を指定し、「イベントラベル」タブを選択した場合の表示例です。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18820700208793\" alt=\"______Media________hbm-simple-p1__________________70____0001.png\" width=\"547\" height=\"321\">\n</li>\n<li>記事の「読了」数がイベント数として記録されます。</li>\n<li>上記の数値と記事のセッション数やページビュー数を比較いただければ、「読了率」を算出することも可能です。</li>\n<li>活用される場合は、カスタムレポートの機能などを利用してください。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>記事の文字数レンジ\n<ul>\n<li>文字数についてはURLが「/entry/」 を含む（＝記事を意味する）場合にカスタムディメンションとして値が以下のように設定されます。\n<ul>\n<li>1〜999文字：1000</li>\n<li>1001〜2000文字:2000</li>\n<li>2001〜3000文字:3000</li>\n<li>3001〜4000文字:4000</li>\n<li>4001〜5000文字:5000</li>\n<li>5001〜6000文字:6000</li>\n<li>6001〜7000文字:7000</li>\n<li>7001〜8000文字:8000</li>\n<li>8001〜9000文字:9000</li>\n<li>9001以上:10000</li>\n</ul>\n</li>\n<li>レポート画面例\n<ul>\n<ul>\n<li>以下は、Google Analyticsの「行動」-「サイトコンテンツ」-「すべてのページ」画面で、セカンダリーディメンションとして「文字数」を設定した場合の例です。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18820706434201\" alt=\"______Media________hbm-simple-p1__________________70____0002.png\" width=\"570\" height=\"177\">\n</li>\n<li>記事の文字数と、直帰率やソーシャルシェといったユーザー行動との関連を調べる際にご利用ください。</li>\n<li>活用される場合は、カスタムレポートの機能などを利用してください。</li>\n</ul>\n</ul>\n<p class=\"alert alert-info\">文字数の厳密な判定は行っておらず、JavaScriptで本文領域の「innerText」を使って取得した文字数となっています。ご了承ください。<br>PCとスマホで表示有無の要素調整をされている場合など、同記事に対する環境により異なる文字数が計測される場合があります。予めご了承ください。</p>\n</li>\n</ul>\n</li>\n<li>カテゴリー\n<ul>\n<li>カテゴリーについては、記事のメインカテゴリーがコンテンツカテゴリーの値として設定されます。（複数カテゴリーを設定している場合は最初に設定されているカテゴリーとなります）</li>\n<li>レポート画面例\n<ul>\n<li>以下は、Google Analyticsの「行動」-「サイトコンテンツ」-「すべてのページ」画面で、コンテンツカテゴリー「カテゴリー」を設定した場合の例です。<br><img src=\"https://hatenablogmedia.zendesk.com/hc/article_attachments/18820700311449\" alt=\"______Media________hbm-simple-p1__________________71____0001.png\" width=\"621\" height=\"173\">\n</li>\n<li>記事のカテゴリーごとの閲覧状況や直帰率を確認するといった際にご利用ください。</li>\n<li>活用される場合は、カスタムレポートの機能などを利用してください。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>"
  }
}

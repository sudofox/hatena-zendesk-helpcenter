{"article":{"id":360052244371,"url":"https://mackerelio.zendesk.com/api/v2/help_center/ja/articles/360052244371.json","html_url":"https://support.mackerel.io/hc/ja/articles/360052244371","author_id":390085917472,"comments_disabled":true,"draft":false,"promoted":false,"position":0,"vote_sum":-1,"vote_count":1,"section_id":360007912312,"created_at":"2020-11-06T09:26:30Z","updated_at":"2022-04-05T08:20:11Z","name":"ログ監視 check-logで「UNKNOWN: unexpected end of JSON input」というアラートが発生する原因と対処方法は？","title":"ログ監視 check-logで「UNKNOWN: unexpected end of JSON input」というアラートが発生する原因と対処方法は？","source_locale":"ja","locale":"ja","outdated":false,"outdated_locales":[],"edited_at":"2022-04-05T08:20:11Z","user_segment_id":null,"permission_group_id":1305651,"content_tag_ids":[],"label_names":[],"body":"\u003cul\u003e\n\u003cli\u003echeck-log プラグインは監視対象のログファイルの差分をチェックする仕様のため、監視対象とするファイルの読み込み済みの位置（バイト数）をjson形式で記録しています。\u003c/li\u003e\n\u003cli\u003eこのjsonファイルが破損すると次回のチェック時に読み込むことができずに \u003ccode class=\"c-mrkdwn__code\" data-stringify-type=\"code\"\u003eunexpected end of JSON input\u003c/code\u003eという Unknown アラートが発報されます。\u003c/li\u003e\n\u003cli\u003eファイルの破損は多くの場合がサーバー再起動などによって発生しますが、最新のバージョンでは破損が起こりにくくなっているため、定期的なプラグインのアップデートをおすすめいたします。\u003c/li\u003e\n\u003cli\u003eこのアラートを解消するには原因となる破損したJSONファイルを削除する必要があります。JSONファイルは以下のようなパスに作成されます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eLinux\u003c/h4\u003e\n\u003cpre\u003e/var/tmp/mackerel-agent/check-log/\u0026lt;監視対象のファイルパス\u0026gt;-\u0026lt;hash文字列\u0026gt;.json\u003c/pre\u003e\n\u003ch4\u003eWindows\u003c/h4\u003e\n\u003cpre\u003e％TEMP％\\check-log\\\u0026lt;監視対象のファイルパス\u0026gt;-\u0026lt;hash文字列\u0026gt;.json\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e例えば Linux のホストにて \u003ccode style=\"font-size: 15px;\"\u003e/\u003cspan class=\"wysiwyg-font-size-medium\"\u003evar/log/foo.log\u003c/span\u003e\u003c/code\u003e を監視されている場合は \u003ccode style=\"font-size: 15px;\"\u003e\u003cspan class=\"wysiwyg-font-size-medium\"\u003e/var/tmp/mackerel-agent/check-log/var/log/foo.log-\u0026lt;hash文字列\u0026gt;.json\u003c/span\u003e\u003c/code\u003e となります。\u003c/li\u003e\n\u003cli\u003eWindows Server のホストの場合、システム環境変数の TEMP が指すディレクトリ配下に記録されます。\u003c/li\u003e\n\u003cli\u003e上記ファイルを削除もしくは拡張子を変更するなどして解消されるかご確認ください。\u003c/li\u003e\n\u003c/ul\u003e"}}